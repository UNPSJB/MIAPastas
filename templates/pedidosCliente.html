{% extends 'base.html' %}
{% load staticfiles %}
{% load bootstrap3 %}
{% block contenido %}





<!-- Este es el formulario de recetas -->
<div class="container">
<div class="panel panel-default">
  <div class="panel-heading"><p class="text-center login-title"><font face="tahoma" size="4" color="black"><b>Pedidos de Cliente</b></font></p></div>
  <div class="panel-body">
      <!-- formulario -->

      <form class="form-inline">


          <div class="form-group">

              <div class="form-group">
                    <label for="cuil">Fecha Creacion</label>
                    <input type="text" value="{{filtros.fecha_creacion}}" class="form-control" id="fecha_creacion" placeholder="fecha creacion" >
              </div>
              <div class="form-group">
                    <label for="razon_social">Razon social</label>
                    <input type="text" value="{{filtros.razon_social}}" class="form-control" id="razon_social" placeholder="huevo" >
              </div>
              <div class="form-group">
                    <label for="fecha_desde">Fecha Desde</label>
                    <input type="text" value="{{filtros.fecha_desde}}" class="form-control" id="fecha_desde">
              </div>
              <div class="form-group">
                    <label for="fecha_hasta">Fecha Hasta</label>
                    <input type="text" value="{{filtros.fecha_hasta}}" class="form-control" id="fecha_hasta">
              </div>
                <p>&nbsp;</p>


              <label for="cliente">Cliente</label>

              <select class="form-control" id="cliente" name="cliente">
                              <option value="" selected="selected">---------</option>
                                 {% for p in clientes %}
                                     <option value="{{p.id}}">{{p.razon_social}}</option>
                                {% endfor %}
              </select>

              <label for="tipo_pedido">Tipo Pedido</label>

              <select class="form-control" id="tipo_pedido" name="tipo_pedido">
                                <option value="" selected="selected">---------</option>
                                <option value="1">Fijo</option>
                                <option value="2">Ocacional</option>
                                <option value="3">De Cambio</option>

              </select>

          </div>


          <button type="submit" class="btn btn-default">Filtrar</button>
      </form>

          <p>&nbsp;</p>
      <hr>
      <div class="row">
          <div class="col-md-6">

          <table class="table table-hover" id="datatables" class="display">
            <thead>
            <tr style='cursor:pointer' class='desmarcado'>
                <th>Tipo Pedido</th>
                <th>Cliente</th>
                <th>fecha</th>
            </tr>
            </thead>
              <tbody>
            {% for pedido in pedidos %}
            <tr class="renglon select-item" data-id="{{pedido.id}}" id="renglon-{{pedido.id}}">
                <td>{{pedido.tipo_pedido}}</td>
                <td>{{pedido.cliente.razon_social}}</td>
                <td>{{pedido.fecha_creacion}}</td>

          </tr>
            {% endfor %}
          </tbody>
          </table>

          </div>
          <div class="col-md-2">
              <div class="btn-group btn-group-sm" role="group" aria-label="...">
              <button id="consultar-pedido" type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal"><span class="glyphicon glyphicon-search" aria-hidden="true">  </span></button>
              <button id="modificar-pedido" type="button" class="btn btn-warning" data-toggle="modal" data-target="#myModalModificar" data-backdrop="static"><span class="glyphicon glyphicon-wrench" aria-hidden="true"> </span></button>
              <button id="modal-eliminar" type="button" class="btn btn-danger "><span class="glyphicon glyphicon-trash" aria-hidden="true">    </span></button>
          </div>
              <p></p>
          <a class="btn" href="pedidosClienteAlta"><font face="tahoma" size="2" color="green"><b><span  class="glyphicon glyphicon-ok" aria-hidden="true"> Pedido Fijo</span></b></font></a>
          <a class="btn" href="pedidosClienteAlta"><font face="tahoma" size="2" color="green"><b><span  class="glyphicon glyphicon-ok" aria-hidden="true"> Pedido Ocacional</span></b></font></a>
          <a class="btn" href="pedidosClienteAlta"><font face="tahoma" size="2" color="green"><b><span  class="glyphicon glyphicon-ok" aria-hidden="true"> Pedido Cambio</span></b></font></a>

          </div>
          <div class="col-md-4">

              <div>


              <h3>Totales de los pedidos</h3><table class="table table-hover">
            <thead>

            <tr>
                <th>Producto Terminado</th>
                <th>Cantidad Bolsones</th>

            </tr>
            </thead>
              <tbody>

          </tbody>
          </table>
          </div>
              <hr>
              <row>

                  <div class="form-group col-md-6">
            <label for="exampleInputName2">Total bolsones</label>
            <input type="text" class="form-control" id="exampleInputName2" readonly="">
          </div>
                  </row>


          </div>


          </div>

              <hr>


          </div>

      </div>
       <div>


</div>

    <!-- Modal -->
            <div id="myModalModificar" class="modal fade"  role="dialog"> <!--
            con data-backdrop="static" hace q no se cierre al hacer click afuera del cuadrado del modal
            - Con col-md-offset-4 corremos 4 espacios a la derecha, pdemos usar col-md2 col-md-offset-4 para que quede 4 espacios en blanco primero-->
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 align="center" class="modal-title center">Modificar Pedido</h1>
                  </div>
                  <div class="modal-body">


                    <form class="form-horizontal col-md-12">

                        <h4>Datos del Pedido</h4>
                          <div class="form-group">
                            <label for="exampleInputEmail2" class="col-md-3">N°Pedido</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputEmail2" readonly >
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Tipo de Pedido</label>
                              <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2"  readonly>
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Cuil/Cuit</label>
                              <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2"  readonly>
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputEmail2" class="col-md-3">Razon Social</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputEmail2" readonly >
                          </div></div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Fecha de creacion</label>
                              <div class=" col-md-5">
                            <input type="date" class="form-control" id="exampleInputName2"  readonly>
                          </div></div>

                        <!-- DEPENDIENDO DE QUE TIPO DE PEDIDO ES(CAMBIO, FIJO, OCACIONAL) SE DEBEN MOSTRAR CAMPOS, COMO SE HACE???-->
                      </form>

                      <table class="table table-hover table table-condensed">
                        <thead>
                        <h4>Productos del pedido</h4>
                        <tr>
                            <th>Nombre Producto</th>
                            <th>Cantidad</th>
                            <th>Unidad Medida</th>

                        </tr>
                        </thead>
                          <tbody>

                            <tr>
                          <td>nombre</td>
                          <td>12</td>
                                <td>Kg</td>
                                <td>
                                    <button type="button" class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                                    <button type="button" class="btn btn-success btn-xs" data-toggle="modal" data-target="#myModalCantidad"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>

                                </td>
                      </tr>

                      </tbody>
                      </table>

                  </div>
                  <div class="modal-footer">
                      <!-- Cuando apretamos el boton aceptar, se verifica si cubre el monto total, en base a esose genera un recibo o una factura, y se guarda
                       en el modelo, -->
                    <button type="button" class="btn btn-default" data-dismiss="modal">Aceptar</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>

                  </div>
                </div>

              </div>
            </div>



    <!-- Modal -->
            <div id="myModalCantidad" class="modal fade"  role="dialog"> <!-- con data-backdrop="static" hace q no se cierre al hacer click afuera del cuadrado del modal -->
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 align="center" class="modal-title center">Ingrese nuevos datos al pedido</h1>
                  </div>
                  <div class="modal-body">

                    <div class="form-group">
                            <label for="exampleInputEmail2" class="col-md-3">Cantidad</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputEmail2" placeholder="Nueva Cantidad" >
                          </div></div>

                      <!-- Aca debe ir modificar los dias de la semana si es de tipo fijo , como????-->
                      <br>
                  </div>
                  <div class="modal-footer">
                      <!-- Cuando apretamos el boton aceptar, se verifica si cubre el monto total, en base a esose genera un recibo o una factura, y se guarda
                       en el modelo, -->
                    <button type="button" class="btn btn-default" data-dismiss="modal">Aceptar</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>

                  </div>
                </div>

              </div>
            </div>



     <!-- Modal -->
            <div id="myModal" class="modal fade"  role="dialog"> <!-- con data-backdrop="static" hace q no se cierre al hacer click afuera del cuadrado del modal -->
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h1 align="center" class="modal-title center">Detalles del Pedido</h1>
                  </div>
                  <div class="modal-body">


                    <form class="form-horizontal col-md-12">

                        <h4>Datos del Pedido</h4>
                          <div class="form-group">
                            <label for="exampleInputEmail2" class="col-md-3">N°Pedido</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputEmail2" readonly >
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Tipo de Pedido</label>
                              <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2"  readonly>
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Cuil/Cuit</label>
                              <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2"  readonly>
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputEmail2" class="col-md-3">Razon Social</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputEmail2" readonly >
                          </div></div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Fecha de creacion</label>
                              <div class=" col-md-5">
                            <input type="date" class="form-control" id="exampleInputName2"  readonly>
                          </div></div>

                        <!-- DEPENDIENDO DE QUE TIPO DE PEDIDO ES(CAMBIO, FIJO, OCACIONAL) SE DEBEN MOSTRAR CAMPOS, COMO SE HACE???-->
                      </form>

                      <table class="table table-hover">
                        <thead>
                        <h4>Productos del pedido</h4>
                        <tr>
                            <th>Nombre Producto</th>
                            <th>Cantidad</th>
                            <th>Unidad Medida</th>

                        </tr>
                        </thead>
                          <tbody>
                        {% for pedido in pedidos %}
                            <tr>
                          <td>{{pedido.tipo_pedido}}</td>
                          <td>{{pedido.fecha_crecion}}</td>
                      </tr>
                        {% endfor %}
                      </tbody>
                      </table>

                  </div>
                  <div class="modal-footer">
                      <!-- Cuando apretamos el boton aceptar, se verifica si cubre el monto total, en base a esose genera un recibo o una factura, y se guarda
                       en el modelo, -->
                    <button type="button" class="btn btn-default" data-dismiss="modal">Aceptar</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>

                  </div>
                </div>

              </div>
            </div>
</div>

    <!-- Este es el fin del formulario de recetas -->

{% endblock %}
{% block javascript %}
<script>
  $(function() {
    $( "#fecha-desde" ).datepicker();
    $( "#fecha-hasta" ).datepicker();


    var id;
        function obtenerId(event) {
            var $el = $(this);          //con this se referencia al objeto de clase select-item que ocaciono el evento, el id se define en el html
            id = $el.data()["id"];
            $el.addClass("danger");
            var _renglon = "";
            _renglon= "#renglon-"+id;
            $(".select-item").removeClass("danger");        //quito la clase active, para q se deseleccionen
            $(_renglon).addClass("danger");
        }

        $(".select-item").click(obtenerId);     //todos los elementos de clase "selec-item", al hacerles clic se ejecuta "obtenerId"

        function mostrar_error(){
            BootstrapDialog.show({
                    title: "Error",
                    cssClass: 'error-dialog',
                    message: "Debe seleccionar un pedido",
                    type: BootstrapDialog.TYPE_DANGER,
                    buttons: [{
                            label: 'Aceptar',
                            action: function(dialogRef){
                                dialogRef.close();
                            }
                    }]
            });
        }

         function mostrarModal(){
            if(id==undefined){
                mostrar_error();
            }else{
                BootstrapDialog.show({
                            title: "Esta intentando eliminar",
                            cssClass: 'error-dialog',
                            message: "Esta seguro que quiere eliminar el pedido?",
                            type: BootstrapDialog.TYPE_DANGER,
                            buttons: [{
                                    label: 'Aceptar',
                                    action: function(dialogRef){
                                        dialogRef.close();
                                        eliminar();}
                                        },{
                                    label: 'Cancelar',
                                    action: function(dialogRef){
                                        dialogRef.close();
                                    }
                                    }
                            ]
                        });
            }
        }

        $("#modal-eliminar").click(mostrarModal);

        function eliminar() {
            window.open('/pedidosCliente/Baja/'+id+'',"_self")
        }

        function modificar(){
            if(id==undefined){
                mostrar_error();
            }else{
            window.open('/c/Modificar/'+id+'',"_self")
        }}


        function consultar(){
            if(id==undefined){
            mostrar_error();
            }else{
            window.open('/pedidosCliente/Consulta/'+id+'',"_self")
            }

        }


        $("#modificar-pedido").click(modificar);
        $("#consultar-pedido").click(consultar);

  });
  </script>
{% endblock %}