{% extends 'base.html' %}
{% load staticfiles %}

{% block contenido %}



<!-- Este es el formulario de recetas -->
<div class="container">
<div class="panel panel-default">
  <div class="panel-heading"><p class="text-center login-title"><font face="tahoma" size="4" color="black"><b>Hoja de Ruta</b></font></p></div>
  <div class="panel-body">
      <!-- formulario -->
      <form class="form-inline">
          <div class="form-group">
            <label for="exampleInputName2">N° de Hoja de Ruta</label>
            <input type="text" class="form-control" id="exampleInputName2" placeholder="N° hoja de ruta" readonly>
          </div>
          <div class="form-group">
            <label for="exampleInputEmail2">Fecha</label>
            <input type="date" class="form-control" id="exampleInputEmail2" placeholder="huevo" readonly>
          </div>
          <div class="form-group">
                        <label for="inputEmail3">Chofer</label><!-- automaticamente debe mostrar solo los choferes disponibles, sin hoja de ruta asignada -->
                          <select class="form-control">
                              <option>--------</option>
                              {% for chofer in choferes %}
                              <option>{{chofer.nombre}}</option>
                              {% endfor %}
                          </select>

                   </div>            <tr>

      </form>
          <p>&nbsp;</p>
      <div class="row">
          <div class="col-md-6">

          <table class="table table-hover" id="datatables" class="display">
                <thead>
                    <h1>Pedidos para el día</h1>
                    <tr>
                        <th>N° Pedido</th>
                        <th>Razon Social</th>
                        <th>Ciudad</th>
                        <th>Zona</th>
                    </tr>
                </thead>

                <tbody>
                    {% for pedido in pedidos %}
                    <tr class="renglon select-item" data-id="{{pedido.id}}" id="renglon-{{pedido.id}}">
                        <td>{{pedido.id}}</td>
                        <td>{{pedido.cliente.razon_social}}</td>
                        <td>{{pedido.cliente.ciudad.nombre}}</td>
                        <td>{{pedido.cliente.ciudad.zona.nombre}}</td>
                        <td><button type="button" class=" glyphicon glyphicon-zoom-in pull-left" data-toggle="modal" data-target="#myModal"></button></td><!-- Trigger the modal with a button -->
                    </tr>
                    {% endfor %}
                </tbody>
          </table>
          </div>

          <div class="col-md-1">
              <div class="btn background-position:top center" role="group" aria-label="..." >
              <button type="button" onclick="agregarHojaDeRuta()" class="btn btn-success pull-right"><span class="glyphicon glyphicon-arrow-right" aria-hidden="true">    </span></button>
              <button type="button" class="btn btn-danger pull-left"><span class="glyphicon glyphicon-arrow-left" aria-hidden="true"> </span></button>
          </div>
          <p></p>
          </div>


          <div class="col-md-5">
              <table id="tablaPedidosAsignados" class="table table-hover">
                    <thead>
                        <h1>Pedidos asignados</h1>
                        <tr>
                            <th>N° Pedido</th>
                            <th>Razon Social</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpoPedidosAsignados">
                        {% for receta in recetas %}
                        <tr>
                          <td>{{receta.nombre}}</td>
                          <td>{{receta.descripcion}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
              </table>
          </div>

          </div>
      <div class="row">
          <div class="col-md-7">

          </div>



          <div class="col-md-5">
              <div>
                    <!-- Trigger the modal with a button -->
              <button type="button" class=" glyphicon glyphicon-shopping-cart pull-right btn btn-info" data-toggle="modal" data-target="#ModalProductosExtra"> Agregar extras</button>


              <table class="table table-hover">
            <thead>
            <h1>Totales para envio</h1>
            <tr>
                <th>Producto Terminado</th>
                <th>Cantidad Bolsones</th>
                <th>Precio</th>
            </tr>
            </thead>
              <tbody>
            {% for receta in recetas %}
                <tr>
              <td>{{receta.nombre}}</td>
              <td>{{receta.descripcion}}</td>
          </tr>
            {% endfor %}
          </tbody>
          </table>
          </div>
              <hr>
              <row>
              <div class="form-group col-md-6">
            <label for="exampleInputName2">Precio Total</label>
            <input type="text" class="form-control" id="exampleInputName2" readonly>
          </div>
                  <div class="form-group col-md-6">
            <label for="exampleInputName2">Total bolsones</label>
            <input type="text" class="form-control" id="exampleInputName2" readonly>
          </div>
                  </row>

          </div>

      </div>
       <div>
            <!-- cuando se hace clic en imprimir se debe guardar en la BD la hoja de ruta, y actualizar los stock disponible y recerbado-->
          <button type="button" class="btn btn-primary active pull-right"><span  class="glyphicon glyphicon-print" aria-hidden="true"> Imprimir </span></button>
          <button type="button" class="btn btn-primary active pull-right"><span  class="glyphicon glyphicon-eye-open" aria-hidden="true"> Ver </span></button>


            <!-- Modal -->
            <div id="myModal" class="modal fade" role="dialog">
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Pedido del día</h4>
                  </div>
                  <div class="modal-body">
                    <form class="form-horizontal col-md-12">
                          <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">N°Pedido</label>
                              <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2" placeholder="fideo fino" readonly>
                          </div></div>
                          <div class="form-group">
                            <label for="exampleInputEmail2" class="col-md-3">Tipo de pedido</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputEmail2" placeholder="huevo" readonly>
                          </div></div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">Cliente</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2" placeholder="fideo fino" readonly>
                          </div></div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="col-md-3">dirección</label>
                            <div class=" col-md-5">
                            <input type="text" class="form-control" id="exampleInputName2" placeholder="fideo fino" readonly>
                          </div></div>

                      </form>
                      <table class="table table-hover">
                        <thead>
                        <h1>Detalle de productos del pedido</h1>
                        <tr>
                            <th>Producto Terminado</th>
                            <th>Cantidad Bolsones</th>
                        </tr>
                        </thead>
                          <tbody>
                        {% for receta in recetas %}
                            <tr >
                          <td>{{receta.nombre}}</td>
                          <td>{{receta.descripcion}}</td>
                      </tr>
                        {% endfor %}
                      </tbody>
                      </table>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  </div>
                </div>

              </div>
            </div>


           <!-- Modal de PRODUCTOS EXTRAS -->
            <div id="ModalProductosExtra" class="modal fade" role="dialog">
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Agregar productos extra</h4>
                  </div>
                  <div class="modal-body">
                    <div class="form-group col-md-5">
                        <label for="inputEmail3">Producto Terminado</label>

                          <select class="form-control">
                              <option>Producto 1</option>
                              <option>producto 2</option>
                              <option>producto 3</option>
                          </select>

                   </div>
                      <div class="form-group col-md-5">
                            <label for="exampleInputEmail2">Cantidad a agregar</label>
                            <input type="text" class="form-control" id="exampleInputEmail2" placeholder="cantidad" >
                          </div>
                      <div class="form-group col-md-1">
                            <label for="exampleInputEmail2"></label>
                            <button type="button" class="boton_bottom btn btn-success pull-down"><span class="glyphicon glyphicon-arrow-right" aria-hidden="true">    </span></button>

                          </div>

                      <table class="table table-hover">
                        <thead>
                        <h1>Detalle de productos extras</h1>
                        <tr>
                            <th>Producto Terminado</th>
                            <th>Cantidad Bolsones</th>
                        </tr>
                        </thead>
                          <tbody>
                        {% for receta in recetas %}
                            <tr>
                          <td>{{receta.nombre}}</td>
                          <td>{{receta.descripcion}}</td>
                      </tr>
                        {% endfor %}
                      </tbody>
                      </table>
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-dismiss="modal">Aceptar</button>
                      <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>

                  </div>
                </div>




      </div>
  </div>

</div>
</div>
</div>
</div>
    <!-- Este es el fin del formulario de recetas -->

{% endblock %}
{% block javascript %}
<script>
var id;
var $el;
var pedidosAsignados=[];
        $(function() {

        var estado;
        function obtenerId(event) {
            $el = $(this);          //con this se referencia al objeto de clase select-item que ocaciono el evento, el id se define en el html
            id = $el.data()["id"];
            estado = $el.data()["estado"]; //obtengo el estado del pedido donde hice click
            console.log(estado)
            $el.addClass("danger");
            var _renglon = "";
            _renglon= "#renglon-"+id;
            $(".select-item").removeClass("danger");        //quito la clase active, para q se deseleccionen
            $(_renglon).addClass("danger");
        }

        $(".select-item").click(obtenerId);     //todos los elementos de clase "selec-item", al hacerles clic se ejecuta "obtenerId"

       });

       function agregarHojaDeRuta(){
            var nro_pedido;
            var razon_social;
            var cont = 0;
            $el.hide(); // en vez de hide se puede usar remove(), show()
            $el.find('td').each (function() {
              if(cont==0)
                nro_pedido = $(this).html();//me muestra el codigo html del objeto al que esta asignado
              if(cont==1)
                razon_social = $(this).html();
              cont=cont+1;
            });

            $('#tablaPedidosAsignados').append('<tr><td>'+nro_pedido+'</td><td>'+razon_social+'</td></tr>');

       }
</script>
{% endblock %}
